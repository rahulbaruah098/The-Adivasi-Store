{% extends "base.html" %}

{% block content %}
<main>
  <section class="section" style="padding:130px 20px 80px;background:#f4ece0;">
    <div style="max-width:1100px;margin:0 auto;display:grid;grid-template-columns:minmax(0,1.1fr) minmax(0,0.9fr);gap:40px;align-items:flex-start;">
      <!-- LEFT: big image -->
      <div style="position:relative;">
        <div style="border-radius:24px;overflow:hidden;box-shadow:0 26px 48px rgba(0,0,0,0.32);background:#d3c6b6;">
          <img src="{{ product.image }}" alt="{{ product.name }}" style="width:100%;display:block;object-fit:cover;max-height:600px;">
        </div>
        {% if product.hover_image %}
        <div style="position:absolute;right:18px;bottom:18px;width:86px;height:86px;border-radius:18px;overflow:hidden;border:2px solid rgba(255,255,255,0.9);box-shadow:0 16px 30px rgba(0,0,0,0.35);background:#e0d5c9;">
          <img src="{{ product.hover_image }}" alt="{{ product.name }} detail" style="width:100%;height:100%;object-fit:cover;">
        </div>
        {% endif %}
      </div>

      <!-- RIGHT: info + add to cart -->
      <div>
        <div style="font-family:'Fjalla One',sans-serif;font-size:11px;letter-spacing:0.24em;text-transform:uppercase;color:#8a6b46;margin-bottom:10px;">
          {{ product.category }}
        </div>
        <h1 class="hero-title-main" style="font-size:26px;letter-spacing:0.14em;text-transform:uppercase;margin-bottom:10px;">
          {{ product.name }}
        </h1>
        <div style="font-size:14px;color:#6b5a48;max-width:420px;margin-bottom:18px;">
          {{ product.description }}
        </div>

        <div style="font-size:15px;margin-bottom:24px;">
          <span style="font-size:11px;letter-spacing:0.18em;text-transform:uppercase;margin-right:4px;">Rs.</span>
          <span style="font-size:20px;font-weight:600;">
            {{ "%.0f"|format(product.price) }}
          </span>
        </div>

        <form method="POST" style="display:flex;flex-direction:column;gap:18px;max-width:360px;">
          {% if product.colors %}
          <div>
            <div style="font-size:11px;letter-spacing:0.18em;text-transform:uppercase;margin-bottom:6px;color:#7a6651;">Colour</div>
            <div style="display:flex;flex-wrap:wrap;gap:8px;">
              {% for c in product.colors %}
                <label style="cursor:pointer;">
                  <input type="radio" name="color" value="{{ c }}" {% if loop.first %}checked{% endif %} style="display:none;">
                  <span style="display:inline-flex;align-items:center;justify-content:center;padding:6px 14px;border-radius:999px;border:1px solid rgba(53,35,20,0.6);font-size:11px;letter-spacing:0.18em;text-transform:uppercase;background:#fdf7ee;transition:background 0.18s ease,transform 0.18s ease;">
                    {{ c }}
                  </span>
                </label>
              {% endfor %}
            </div>
          </div>
          {% endif %}

          {% if product.sizes %}
          <div>
            <div style="font-size:11px;letter-spacing:0.18em;text-transform:uppercase;margin-bottom:6px;color:#7a6651;">Size</div>
            <div style="display:flex;flex-wrap:wrap;gap:8px;">
              {% for s in product.sizes %}
                <label style="cursor:pointer;">
                  <input type="radio" name="size" value="{{ s }}" {% if loop.first %}checked{% endif %} style="display:none;">
                  <span style="display:inline-flex;align-items:center;justify-content:center;width:40px;height:32px;border-radius:999px;border:1px solid rgba(53,35,20,0.6);font-size:11px;letter-spacing:0.16em;text-transform:uppercase;background:#fff7ed;transition:background 0.18s ease,transform 0.18s ease;">
                    {{ s }}
                  </span>
                </label>
              {% endfor %}
            </div>
          </div>
          {% endif %}

          <button type="submit"
                  id="pd-add-btn"
                  style="margin-top:4px;display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:11px 28px;border-radius:999px;border:1px solid rgba(27,14,6,0.9);background:#21120b;color:#fff;text-transform:uppercase;letter-spacing:0.22em;font-size:11px;font-family:'Fjalla One',sans-serif;cursor:pointer;box-shadow:0 14px 26px rgba(0,0,0,0.4);transition:transform 0.18s ease,box-shadow 0.18s ease,background 0.18s ease;">
            <span>Add to cart</span>
            <span style="display:inline-flex;width:18px;height:18px;border-radius:50%;border:1px solid rgba(255,255,255,0.8);align-items:center;justify-content:center;">
              <span style="width:8px;height:8px;border-radius:1px;border:1px solid rgba(255,255,255,0.85);"></span>
            </span>
          </button>
        </form>

        <div style="margin-top:20px;font-size:11px;color:#7a6a55;">
          Free size guidance & care instructions shared over WhatsApp after order confirmation.
        </div>
      </div>
    </div>

    <!-- Funky added-to-cart overlay -->
    <div id="pd-toast" style="
      position:fixed;
      left:50%;
      top:18%;
      transform:translate(-50%, -40px) scale(.9);
      background:#1d120c;
      color:#fff7ea;
      padding:10px 18px;
      border-radius:999px;
      font-size:11px;
      letter-spacing:0.16em;
      text-transform:uppercase;
      font-family:'Fjalla One',sans-serif;
      display:none;
      align-items:center;
      gap:10px;
      box-shadow:0 18px 40px rgba(0,0,0,0.5);
      z-index:9999;
    ">
      <span style="width:18px;height:18px;border-radius:50%;border:1px solid rgba(255,255,255,0.85);display:inline-flex;align-items:center;justify-content:center;">
        âœ“
      </span>
      <span>Item added to cart</span>
    </div>

    <script>
      // Turn pill labels into visually "selected" states
      (function(){
        document.querySelectorAll('form input[type="radio"]').forEach(inp => {
          inp.addEventListener("change", () => {
            const name = inp.name;
            document.querySelectorAll('input[name="'+name+'"]').forEach(el => {
              const pill = el.parentElement.querySelector("span");
              pill.style.background = el.checked ? "#21120b" : "#fdf7ee";
              pill.style.color = el.checked ? "#fff7ea" : "#21120b";
            });
          });
        });

        // initialise defaults
        document.querySelectorAll('form input[type="radio"]:checked').forEach(el => {
          const pill = el.parentElement.querySelector("span");
          pill.style.background = "#21120b";
          pill.style.color = "#fff7ea";
        });

        // small toast before redirect (visual only, submission still goes through)
        const btn = document.getElementById("pd-add-btn");
        const toast = document.getElementById("pd-toast");
        if(btn && toast){
          btn.addEventListener("click", () => {
            toast.style.display = "inline-flex";
            toast.style.opacity = "0";
            toast.style.transition = "opacity 0.2s ease, transform 0.2s ease";
            requestAnimationFrame(() => {
              toast.style.opacity = "1";
              toast.style.transform = "translate(-50%, 0) scale(1)";
            });
            setTimeout(() => {
              toast.style.opacity = "0";
              toast.style.transform = "translate(-50%, -20px) scale(.96)";
            }, 900);
          });
        }
      })();
    </script>
  </section>
</main>
{% endblock %}
