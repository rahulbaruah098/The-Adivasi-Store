{% extends "base.html" %}

{% block content %}
  <!-- HERO -->
  <main>
    <section class="hero" id="hero" data-parallax>
      <div class="hero-inner">
        <div class="hero-kicker">Traditional Shop</div>
        <div class="hero-title-main">The ADIVASI STORE</div>
        <div class="hero-kicker-1">Crafted in Culture</div>
        <p class="hero-subtitle">
          Traditional Adivasi weaves, soft as memory and vibrant as our roots, handcrafted with care and culture—designed to be worn, cherished and passed on through generations.
        </p>
        <a href="/shop" class="hero-cta">OUR SHOP</a>
      </div>
    </section>

    <!-- CATEGORY GRID -->
<section class="section" id="shop">
  <div class="category-grid">

    <div class="category-card cat-saree">
      <div class="category-label">Saree</div>
    </div>

    <div class="category-card cat-bandi">
      <div class="category-label">Bandi</div>
    </div>

    <div class="category-card cat-bags">
      <div class="category-label">Bags</div>
    </div>

    <div class="category-card cat-gamosa">
      <div class="category-label">Gamosa</div>
    </div>

    <div class="category-card cat-shawl">
      <div class="category-label">Shawl</div>
    </div>

  </div>

  <div class="category-row-two" id="accessories">

    <div class="category-card cat-kids-kurta">
      <div class="category-label">Kurta Pyjama</div>
    </div>


    <div class="category-card cat-chandrahaar">
      <div class="category-label">Chandrahaar</div>
    </div>

    <div class="category-card cat-hashli">
      <div class="category-label">Hashli</div>
    </div>

    <div class="category-card cat-baju">
      <div class="category-label">Baju</div>
    </div>


  </div>
</section>







    <!-- ===== PRODUCT STRIP SECTION (women/men/kids) ===== -->
  <section id="adivasi-product-strip">
      <!-- INLINE CSS JUST FOR THIS SECTION -->
        <style>
          /* ===== Adivasi Store – Product Strip (scoped) ===== */
          #adivasi-product-strip{
            padding:40px 60px 60px;
            background:#f2eee8;
            font-family:"Playfair Display",serif;
            color:#151517;
          }

          #adivasi-product-strip .aps-inner{
            max-width:1240px;
            margin:0 auto;
          }

          /* Tabs (Women / Men / Kids / Ornaments) */
          #adivasi-product-strip .aps-tabs{
            display:flex;
            gap:28px;
            margin-bottom:26px;
            font-size:18px;
          }

          #adivasi-product-strip .aps-tab{
            background:none;
            border:none;
            padding:0 0 4px;
            cursor:pointer;
            font:inherit;
            color:#7c7a76;
            position:relative;
          }

          #adivasi-product-strip .aps-tab::after{
            content:"";
            position:absolute;
            left:0;
            bottom:0;
            width:0;
            height:2px;
            background:#151517;
            transition:width .25s ease;
          }

          #adivasi-product-strip .aps-tab.aps-tab--active{
            color:#151517;
          }

          #adivasi-product-strip .aps-tab.aps-tab--active::after{
            width:100%;
          }

          /* Product grid (desktop/tablet) */
          #adivasi-product-strip .aps-grid{
            display:grid;
            grid-template-columns:repeat(auto-fit,minmax(210px,1fr));
            gap:24px;
          }

          #adivasi-product-strip .aps-card{
            background:#e4ded5;
            padding:16px 16px 18px;
            display:flex;
            flex-direction:column;
            height:100%;
            position:relative;
            min-width:0;
          }

          #adivasi-product-strip .aps-media{
            position:relative;
            background:#d7d1c7;
            overflow:hidden;
            aspect-ratio:3/4;
            margin-bottom:14px;
          }

          #adivasi-product-strip .aps-img{
            position:absolute;
            inset:0;
            width:100%;
            height:100%;
            object-fit:cover;
            transition:opacity .35s ease;
          }

          #adivasi-product-strip .aps-img.aps-primary{ opacity:1; }
          #adivasi-product-strip .aps-img.aps-hover{ opacity:0; }

          #adivasi-product-strip .aps-card:hover .aps-img.aps-primary{ opacity:0; }
          #adivasi-product-strip .aps-card:hover .aps-img.aps-hover{ opacity:1; }

          /* Add-to-cart round button with SVG bag */
          #adivasi-product-strip .aps-add{
            position:absolute;
            right:10px;
            bottom:10px;
            width:30px;
            height:30px;
            border-radius:50%;
            border:none;
            background:rgba(255,255,255,0.96);
            display:flex;
            align-items:center;
            justify-content:center;
            cursor:pointer;
            box-shadow:0 4px 8px rgba(0,0,0,0.18);
            transition:transform .2s ease, box-shadow .2s ease;
          }

          #adivasi-product-strip .aps-add svg{ width:18px; height:18px; }

          #adivasi-product-strip .aps-add path{
            stroke:#151517;
            stroke-width:1.6;
            fill:none;
            stroke-linejoin:round;
            stroke-linecap:round;
          }

          #adivasi-product-strip .aps-add:hover{
            transform:translateY(-2px);
            box-shadow:0 6px 14px rgba(0,0,0,0.24);
          }

          /* Text */
          #adivasi-product-strip .aps-info{
            display:flex;
            flex-direction:column;
            flex:1;
          }

          #adivasi-product-strip .aps-name{
            font-size:13px;
            letter-spacing:.13em;
            text-transform:uppercase;
            margin-bottom:6px;
          }

          #adivasi-product-strip .aps-price-line{
            display:flex;
            align-items:baseline;
            gap:4px;
            font-size:13px;
            margin-bottom:4px;
          }

          #adivasi-product-strip .aps-price-label{
            letter-spacing:.18em;
            text-transform:uppercase;
          }

          #adivasi-product-strip .aps-price{ font-size:13px; }

          #adivasi-product-strip .aps-subtitle{
            font-size:11px;
            letter-spacing:.15em;
            text-transform:uppercase;
            color:#7c7a76;
            font-style:italic;
          }

          /* ✨ Funky "added to cart" animation */
          #adivasi-product-strip .aps-card.aps-added .aps-add{
            animation:aps-pop .55s ease-out;
          }

          #adivasi-product-strip .aps-added-tag{
            position:absolute;
            left:12px;
            bottom:12px;
            padding:4px 10px;
            border-radius:999px;
            background:rgba(0,0,0,0.86);
            color:#fff;
            font-size:10px;
            letter-spacing:.16em;
            text-transform:uppercase;
            font-family:"Fjalla One",sans-serif;
            pointer-events:none;
            opacity:0;
            transform:translateY(8px) scale(.9);
            animation:aps-tag-pop .7s ease-out forwards;
          }

          @keyframes aps-pop{
            0%{transform:translateY(0) scale(1);}
            35%{transform:translateY(-4px) scale(1.15) rotate(-4deg);}
            70%{transform:translateY(1px) scale(.96) rotate(2deg);}
            100%{transform:translateY(0) scale(1);}
          }

          @keyframes aps-tag-pop{
            0%{opacity:0;transform:translateY(8px) scale(.9);}
            30%{opacity:1;transform:translateY(0) scale(1);}
            100%{opacity:0;transform:translateY(-10px) scale(.95);}
          }

          /* Responsive tweaks – section-only */
          @media (max-width:900px){
            #adivasi-product-strip{
              padding:28px 20px 42px;
            }
            #adivasi-product-strip .aps-tabs{
              font-size:16px;
              gap:18px;
            }
            #adivasi-product-strip .aps-grid{
              grid-template-columns:repeat(2,minmax(0,1fr));
            }
          }

          /* ✅ MOBILE: keep products in a HORIZONTAL strip (like web), not vertical */
          @media (max-width:600px){
            #adivasi-product-strip{
              padding:24px 18px 40px;
            }

            /* Turn grid into horizontal scroller */
            #adivasi-product-strip .aps-grid{
              display:flex;
              gap:14px;
              overflow-x:auto;
              overflow-y:hidden;
              -webkit-overflow-scrolling:touch;
              padding-bottom:6px;
              scroll-snap-type:x mandatory;
            }

            /* Each card keeps a fixed width so multiple cards slide horizontally */
            #adivasi-product-strip .aps-card{
              flex:0 0 78%;
              max-width:78%;
              scroll-snap-align:start;
              padding:12px 12px 16px;
            }

            /* Optional: nicer thin scrollbar */
            #adivasi-product-strip .aps-grid::-webkit-scrollbar{ height:6px; }
            #adivasi-product-strip .aps-grid::-webkit-scrollbar-thumb{
              background:rgba(0,0,0,0.18);
              border-radius:999px;
            }
            #adivasi-product-strip .aps-grid::-webkit-scrollbar-track{
              background:transparent;
            }

            #adivasi-product-strip .aps-name{font-size:12px;}
            #adivasi-product-strip .aps-price-line,
            #adivasi-product-strip .aps-price{font-size:12px;}
            #adivasi-product-strip .aps-subtitle{font-size:10px;}
          }

          /* Extra small phones: show a bit more of next card */
          @media (max-width:420px){
            #adivasi-product-strip .aps-card{
              flex-basis:86%;
              max-width:86%;
            }
          }

           .aps-toggle-card { cursor: pointer; }

            .aps-toggle-inner{
              height: 100%;
              min-height: 260px; /* adjust to match your card height */
              display: grid;
              place-items: center;
              border: 1px solid rgba(0,0,0,0.10);
              background: rgba(255,255,255,0.35);
            }

            .aps-toggle-text{
              font-weight: 600;
              letter-spacing: 0.08em;
              text-transform: uppercase;
            }

        </style>

        <!-- HTML CONTENT OF THE SECTION -->
        <div class="aps-inner">
          <div class="aps-tabs">
            <button class="aps-tab aps-tab--active" data-gender="women">Women</button>
            <button class="aps-tab" data-gender="men">Men</button>
            <button class="aps-tab" data-gender="kids">Kids</button>
            <button class="aps-tab" data-gender="ornaments">Ornaments</button>
          </div>

          <div class="aps-grid">
            <!-- JS will inject product cards here -->
          </div>
        </div>

          <!-- INLINE JS JUST FOR THIS SECTION -->
      <script>
        const apsSection = document.getElementById("adivasi-product-strip");
        const apsGrid   = apsSection.querySelector(".aps-grid");
        const apsTabs   = apsSection.querySelectorAll(".aps-tab");

        const apsApiBase = "{{ url_for('api_aps_products') }}";

        const apsProductDetailBase   = "{{ url_for('product_detail', product_id='__PID__') }}";
        const apsProductDetailPrefix = apsProductDetailBase.replace("__PID__", "");
        const apsAddToCartBase       = "{{ url_for('add_to_cart') }}";

        // Show 5 items by default
        const APS_SHOW_COUNT = 5;

        // Expanded state per tab
        const apsExpanded = { women: false, men: false, kids: false, ornaments: false };

        async function fetchApsProducts(gender){
          const url = apsApiBase + "?" + new URLSearchParams({ gender });
          const res = await fetch(url, { credentials: "include" });
          const data = await res.json();
          return data.items || [];
        }

        function apsShowAddedAnimation(card){
          if(!card) return;
          card.classList.add("aps-added");

          const oldTag = card.querySelector(".aps-added-tag");
          if(oldTag) oldTag.remove();

          const tag = document.createElement("div");
          tag.className = "aps-added-tag";
          tag.textContent = "Added to cart";
          card.appendChild(tag);

          const navCart = document.querySelector(".nav-cart");
          if(navCart){
            navCart.classList.add("nav-cart--ping");
            setTimeout(()=>navCart.classList.remove("nav-cart--ping"), 650);
          }

          setTimeout(()=>{
            card.classList.remove("aps-added");
            if(tag && tag.parentNode){ tag.parentNode.removeChild(tag); }
          }, 900);
        }

        function makeToggleCard(label, onClick){
          const card = document.createElement("article");
          card.className = "aps-card aps-toggle-card";
          card.innerHTML = `
            <div class="aps-toggle-inner">
              <span class="aps-toggle-text">${label}</span>
            </div>
          `;
          card.addEventListener("click", (ev) => {
            ev.preventDefault();
            ev.stopPropagation();
            onClick();
          });
          return card;
        }

        function renderOneCard(p){
          const primary = (p.images && p.images.primary) ? p.images.primary : "";
          const hover   = (p.images && p.images.hover) ? p.images.hover : primary;

          const card = document.createElement("article");
          card.className = "aps-card";
          card.dataset.productId = p.id || "";

          card.innerHTML = `
            <div class="aps-media">
              <img class="aps-img aps-primary" src="${primary}" alt="${p.name || ""}">
              <img class="aps-img aps-hover" src="${hover}" alt="${p.name || ""}">
              <button class="aps-add" type="button" title="Add to cart">
                <svg viewBox="0 0 24 24" aria-hidden="true">
                  <path d="M8 9c0-2.2 1.8-4 4-4s4 1.8 4 4"></path>
                  <path d="M7 9h10l-1 9H8L7 9z"></path>
                </svg>
              </button>
            </div>
            <div class="aps-info">
              <div class="aps-name">${p.name || ""}</div>
              <div class="aps-price-line">
                <span class="aps-price-label">Rs.</span>
                <span class="aps-price">${p.price ?? ""}</span>
              </div>
              <div class="aps-subtitle">${p.category_label || ""}</div>
            </div>
          `;

          apsGrid.appendChild(card);

          // Add to cart
          const addBtn = card.querySelector(".aps-add");
          if (addBtn) {
            addBtn.addEventListener("click", (ev) => {
              ev.stopPropagation();
              if (!p.id) return;

              const params = new URLSearchParams({
                product_id: p.id,
                name: p.name || "",
                price: p.price ?? 0,
                image: primary
              });

              fetch(apsAddToCartBase + "?" + params.toString(), {
                method: "GET",
                credentials: "include"
              }).catch(()=>{});

              apsShowAddedAnimation(card);
            });
          }

          // Click card -> product detail
          card.addEventListener("click", (ev) => {
            if (ev.target.closest(".aps-add")) return;
            if (!p.id) return;

            const detailUrl = apsProductDetailPrefix + encodeURIComponent(p.id)
              + "?" + new URLSearchParams({ img: primary, hover }).toString();

            window.location.href = detailUrl;
          });
        }

        async function renderApsProducts(gender="women"){
          apsGrid.innerHTML = "";

          const list = await fetchApsProducts(gender);
          const expanded = !!apsExpanded[gender];

          // If <= 5 products, no toggle cards
          if (!list || list.length <= APS_SHOW_COUNT) {
            (list || []).forEach(renderOneCard);
            return;
          }

          if (!expanded) {
            // First 5 products
            list.slice(0, APS_SHOW_COUNT).forEach(renderOneCard);

            // 6th: View All toggle card
            apsGrid.appendChild(
              makeToggleCard("View All", () => {
                apsExpanded[gender] = true;
                renderApsProducts(gender);
              })
            );
            return;
          }

          // Expanded: show all products
          list.forEach(renderOneCard);

          // Last: Collapse toggle card
          apsGrid.appendChild(
            makeToggleCard("Collapse", () => {
              apsExpanded[gender] = false;
              renderApsProducts(gender);

              // optional: scroll back to strip start on collapse
              document.getElementById("adivasi-product-strip")
                ?.scrollIntoView({ behavior: "smooth", block: "start" });
            })
          );
        }

        // Initial render
        renderApsProducts("women");

        // Tabs
        apsTabs.forEach(tab => {
          tab.addEventListener("click", () => {
            apsTabs.forEach(t => t.classList.remove("aps-tab--active"));
            tab.classList.add("aps-tab--active");
            renderApsProducts(tab.dataset.gender);
          });
        });
    </script>


  </section>



    <section id="adivasi-social-posts">
      <!-- ===== INLINE CSS (ONLY FOR THIS SECTION) ===== -->
      <style>
        #adivasi-social-posts{
          position:relative;
          padding:70px 60px 130px;
          background:#f3eee6;
          overflow:hidden;
          font-family:"Playfair Display",serif;
          color:#17130f;
        }

        #adivasi-social-posts .asp-inner{
          max-width:1100px;
          margin:0 auto;
          position:relative;
          z-index:2;
        }

        #adivasi-social-posts .asp-kicker{
          font-family:"Fjalla One",sans-serif;
          letter-spacing:.22em;
          text-transform:uppercase;
          font-size:12px;
          color:#7b6b55;
          margin-bottom:10px;
        }

        #adivasi-social-posts .asp-title{
          font-size:32px;
          letter-spacing:.16em;
          text-transform:uppercase;
          margin-bottom:8px;
        }

        #adivasi-social-posts .asp-sub{
          max-width:520px;
          font-size:14px;
          color:#62584a;
          margin-bottom:46px;
        }

        /* Soft radial glow */
        #adivasi-social-posts::before{
          content:"";
          position:absolute;
          width:520px;
          height:520px;
          border-radius:50%;
          background:radial-gradient(circle,rgba(255,255,255,0.85),transparent 65%);
          top:-160px;
          right:-120px;
          opacity:0.8;
          pointer-events:none;
        }

        /* Spiral line – aligned to posts */
        #adivasi-social-posts .asp-spiral{
          position:absolute;
          inset:140px 0 90px;
          margin:auto;
          max-width:430px;
          width:60vw;
          min-width:260px;
          opacity:.45;
          z-index:0;
          pointer-events:none;
        }

        #adivasi-social-posts .asp-spiral path{
          stroke:#b48a5d;
          stroke-width:3;
          fill:none;
          stroke-linecap:round;
          stroke-linejoin:round;
          stroke-dasharray:7 9;
        }

        /* Vertical track of rows */
        #adivasi-social-posts .asp-track{
          position:relative;
          display:flex;
          flex-direction:column;
          gap:140px;
          padding:6px 0 6px;
          z-index:1;
        }

        /* Each row contains 2 posts */
        #adivasi-social-posts .asp-row{
          display:flex;
          justify-content:space-between;
          gap:60px;
        }

        #adivasi-social-posts .asp-post{
          position:relative;
          display:flex;
          align-items:center;
          gap:28px;
          opacity:0;
          transform:translateY(40px);
          transition:opacity .55s ease, transform .55s ease;
          flex:1;
        }

        #adivasi-social-posts .asp-post.is-visible{
          opacity:1;
          transform:translateY(0);
        }

        #adivasi-social-posts .asp-post--left{
          justify-content:flex-start;
          padding-right:40px;
        }

        #adivasi-social-posts .asp-post--right{
          justify-content:flex-end;
          padding-left:40px;
        }

        /* Phone-style image card with parallax */
        #adivasi-social-posts .asp-frame{
          position:relative;
          width:260px;
          max-width:46vw;
          aspect-ratio:9/16;
          border-radius:22px;
          overflow:hidden;
          background:#e5dccf;
          box-shadow:0 18px 36px rgba(0,0,0,.3);
          transform-origin:center;
          transform:translate3d(0,0,0);
          transition:transform .4s ease-out, box-shadow .4s ease-out;
        }

        #adivasi-social-posts .asp-img{
          display:block;
          width:100%;
          height:100%;
          object-fit:cover;
          transform:scale(1.02);
          transition:transform .5s ease;
        }

        #adivasi-social-posts .asp-frame::before{
          content:"";
          position:absolute;
          inset:12px 11px;
          border-radius:18px;
          border:1px solid rgba(255,255,255,.6);
          pointer-events:none;
        }

        #adivasi-social-posts .asp-frame:hover .asp-img{
          transform:scale(1.06);
        }

        /* Caption box */
        #adivasi-social-posts .asp-meta{
          max-width:320px;
        }

        #adivasi-social-posts .asp-pill{
          display:inline-flex;
          align-items:center;
          gap:6px;
          padding:4px 10px;
          border-radius:999px;
          border:1px solid rgba(23,19,15,.16);
          font-size:11px;
          letter-spacing:.16em;
          text-transform:uppercase;
          background:rgba(255,255,255,.9);
          margin-bottom:8px;
        }

        #adivasi-social-posts .asp-pill-dot{
          width:7px;
          height:7px;
          border-radius:50%;
          background:#b26b39;
        }

        #adivasi-social-posts .asp-meta h3{
          font-size:17px;
          letter-spacing:.16em;
          text-transform:uppercase;
          margin-bottom:6px;
        }

        #adivasi-social-posts .asp-meta p{
          font-size:13px;
          color:#5d5246;
        }

        /* Instagram badge – SVG so always visible */
        #adivasi-social-posts .asp-social-badge{
          position:absolute;
          right:12px;
          bottom:12px;
          width:30px;
          height:30px;
          border-radius:50%;
          background:rgba(246,240,232,.98);
          box-shadow:0 6px 16px rgba(0,0,0,.32);
          display:flex;
          align-items:center;
          justify-content:center;
        }

        #adivasi-social-posts .asp-social-badge svg{
          width:18px;
          height:18px;
          display:block;
        }

        #adivasi-social-posts .asp-social-badge rect,
        #adivasi-social-posts .asp-social-badge circle{
          stroke:#18120f;
          stroke-width:1.6;
          fill:none;
        }

        #adivasi-social-posts .asp-social-badge .insta-dot{
          fill:#18120f;
          stroke:none;
        }

        /* Responsive */
        @media (max-width:900px){
          #adivasi-social-posts{
            padding:60px 26px 100px;
          }
          #adivasi-social-posts .asp-track{
            gap:110px;
          }
          #adivasi-social-posts .asp-row{
            gap:40px;
          }
        }

        @media (max-width:640px){
          #adivasi-social-posts{
            padding:50px 18px 80px;
          }
          #adivasi-social-posts .asp-title{
            font-size:26px;
          }
          #adivasi-social-posts .asp-track{
            gap:80px;
          }
          #adivasi-social-posts .asp-row{
            flex-direction:column;
            gap:60px;
          }
          #adivasi-social-posts .asp-post{
            flex-direction:column;
            align-items:flex-start;
            padding:0 8px;
          }
          #adivasi-social-posts .asp-post--left,
          #adivasi-social-posts .asp-post--right{
            padding:0 8px;
          }
          #adivasi-social-posts .asp-frame{
            width:100%;
            max-width:100%;
          }
          #adivasi-social-posts .asp-meta{
            max-width:100%;
          }
          #adivasi-social-posts .asp-spiral{
            inset:160px -60px 70px;
          }
        }
      </style>

      <!-- ===== HTML CONTENT ===== -->
      <div class="asp-inner">
        <header class="asp-header">
          <div class="asp-kicker">OUR SOCIAL MEDIA POSTS</div>
          <h2 class="asp-title">Stories from The Adivasi Store</h2>
          <p class="asp-sub">
            Handpicked posts from our Instagram feed – new drops, behind-the-scenes
            moments and community love from The Adivasi Store family.
          </p>
        </header>

        <!-- Spiral that connects posts -->
        <svg class="asp-spiral" viewBox="0 0 400 1100" preserveAspectRatio="xMidYMid meet" aria-hidden="true">
          <path d="
            M200 40
            C 90 150, 90 220, 200 300
            S 310 420, 200 520
            S 90 620, 200 720
            S 310 820, 200 920
            S 90 1020, 200 1080
          " />
        </svg>

        <div class="asp-track">
          <!-- Row 1 -->
          <div class="asp-row">
            <article class="asp-post asp-post--left">
              <div class="asp-frame" data-depth="0.25">
                <img class="asp-img" src="{{ url_for('static', filename='images/adi1.jpg') }}" alt="Social post 1">
                <div class="asp-social-badge">
                  <!-- Instagram SVG icon -->
                  <svg viewBox="0 0 24 24" aria-hidden="true">
                    <rect x="4" y="4" width="16" height="16" rx="5" ry="5"></rect>
                    <circle cx="12" cy="12" r="4.2"></circle>
                    <circle class="insta-dot" cx="16.2" cy="7.8" r="1.2"></circle>
                  </svg>
                </div>
              </div>
              <div class="asp-meta">
                <div class="asp-pill">
                  <span class="asp-pill-dot"></span>
                  NEW DROP
                </div>
                <h3>Handwoven warmth</h3>
                <p>
                  A cosy carousel sharing the newest handwoven shawls – shot in golden light
                  and styled with everyday Adivasi life.
                </p>
              </div>
            </article>

            <article class="asp-post asp-post--right">
              <div class="asp-frame" data-depth="0.3">
                <img class="asp-img" src="{{ url_for('static', filename='images/adi2.jpg') }}" alt="Social post 2">
                <div class="asp-social-badge">
                  <svg viewBox="0 0 24 24" aria-hidden="true">
                    <rect x="4" y="4" width="16" height="16" rx="5" ry="5"></rect>
                    <circle cx="12" cy="12" r="4.2"></circle>
                    <circle class="insta-dot" cx="16.2" cy="7.8" r="1.2"></circle>
                  </svg>
                </div>
              </div>
              <div class="asp-meta">
                <div class="asp-pill">
                  <span class="asp-pill-dot"></span>
                  MAKERS' STORY
                </div>
                <h3>Behind the loom</h3>
                <p>
                  A mini photo essay following our artisan through dyeing, weaving and finishing –  
                  showing the craft behind every piece.
                </p>
              </div>
            </article>
          </div>

          <!-- Row 2 -->
          <div class="asp-row">
            <article class="asp-post asp-post--left">
              <div class="asp-frame" data-depth="0.4">
                <img class="asp-img" src="{{ url_for('static', filename='images/adi3.jpg') }}" alt="Social post 3">
                <div class="asp-social-badge">
                  <svg viewBox="0 0 24 24" aria-hidden="true">
                    <rect x="4" y="4" width="16" height="16" rx="5" ry="5"></rect>
                    <circle cx="12" cy="12" r="4.2"></circle>
                    <circle class="insta-dot" cx="16.2" cy="7.8" r="1.2"></circle>
                  </svg>
                </div>
              </div>
              <div class="asp-meta">
                <div class="asp-pill">
                  <span class="asp-pill-dot"></span>
                  COMMUNITY LOVE
                </div>
                <h3>Customer moments</h3>
                <p>
                  Reposts from our community – real people styling The Adivasi Store pieces in
                  their own homes, towns and celebrations.
                </p>
              </div>
            </article>

            <article class="asp-post asp-post--right">
              <div class="asp-frame" data-depth="0.5">
                <img class="asp-img" src="{{ url_for('static', filename='images/insta4.jpeg') }}" alt="Social post 4">
                <div class="asp-social-badge">
                  <svg viewBox="0 0 24 24" aria-hidden="true">
                    <rect x="4" y="4" width="16" height="16" rx="5" ry="5"></rect>
                    <circle cx="12" cy="12" r="4.2"></circle>
                    <circle class="insta-dot" cx="16.2" cy="7.8" r="1.2"></circle>
                  </svg>
                </div>
              </div>
              <div class="asp-meta">
                <div class="asp-pill">
                  <span class="asp-pill-dot"></span>
                  FESTIVE EDIT
                </div>
                <h3>Colours of celebration</h3>
                <p>
                  A grid of bright, festive looks styled for harvest festivals and winter gatherings,
                  captured in natural light.
                </p>
              </div>
            </article>
          </div>

          <!-- Row 3 -->
          <div class="asp-row">
            <article class="asp-post asp-post--left">
              <div class="asp-frame" data-depth="0.65">
                <img class="asp-img" src="{{ url_for('static', filename='images/insta5.jpeg') }}" alt="Social post 5">
                <div class="asp-social-badge">
                  <svg viewBox="0 0 24 24" aria-hidden="true">
                    <rect x="4" y="4" width="16" height="16" rx="5" ry="5"></rect>
                    <circle cx="12" cy="12" r="4.2"></circle>
                    <circle class="insta-dot" cx="16.2" cy="7.8" r="1.2"></circle>
                  </svg>
                </div>
              </div>
              <div class="asp-meta">
                <div class="asp-pill">
                  <span class="asp-pill-dot"></span>
                  MARKET DIARIES
                </div>
                <h3>From haat to home</h3>
                <p>
                  A story-style post tracing how designs travel from local haats to wardrobes across
                  cities and small towns.
                </p>
              </div>
            </article>

            <article class="asp-post asp-post--right">
              <div class="asp-frame" data-depth="0.8">
                <img class="asp-img" src="{{ url_for('static', filename='images/insta6.jpeg') }}" alt="Social post 6">
                <div class="asp-social-badge">
                  <svg viewBox="0 0 24 24" aria-hidden="true">
                    <rect x="4" y="4" width="16" height="16" rx="5" ry="5"></rect>
                    <circle cx="12" cy="12" r="4.2"></circle>
                    <circle class="insta-dot" cx="16.2" cy="7.8" r="1.2"></circle>
                  </svg>
                </div>
              </div>
              <div class="asp-meta">
                <div class="asp-pill">
                  <span class="asp-pill-dot"></span>
                  DROP ALERT
                </div>
                <h3>Next collection preview</h3>
                <p>
                  Teaser shots from the next collection – close-up textures, colour palettes
                  and a hint of what’s coming.
                </p>
              </div>
            </article>
          </div>
        </div>
      </div>

      <!-- ===== INLINE JS (ONLY FOR THIS SECTION) ===== -->
      <script>
        (function(){
          const section = document.getElementById("adivasi-social-posts");
          if(!section) return;

          const posts  = section.querySelectorAll(".asp-post");
          const frames = section.querySelectorAll(".asp-frame");
          const spiral = section.querySelector(".asp-spiral");

          /* Reveal animation for posts */
          const io = new IntersectionObserver((entries)=>{
            entries.forEach(entry=>{
              if(entry.isIntersecting){
                entry.target.classList.add("is-visible");
              }
            });
          },{
            root:null,
            threshold:0.25
          });
          posts.forEach(p=>io.observe(p));

          /* Helper clamp */
          const clamp = (v,min,max) => (v < min ? min : v > max ? max : v);

          /* Parallax float for frames + subtle spiral movement */
          function handleScroll(){
            const rect = section.getBoundingClientRect();
            const vh   = window.innerHeight || document.documentElement.clientHeight;

            // progress -1 (top far above) to +1 (far below)
            const centerOffset = (rect.top + rect.height/2) - vh/2;
            const progress = clamp(centerOffset / rect.height, -1, 1);

            frames.forEach((frame, index)=>{
              const depth = parseFloat(frame.dataset.depth || "0.4");
              const maxOffset = 60; // px, keeps images inside section
              const offset = -progress * depth * maxOffset;
              const angle  = -progress * (index - 2) * 3; // small rotation
              frame.style.transform = `translateY(${offset}px) rotate(${angle}deg)`;
            });

            if(spiral){
              const spiralOffset = -progress * 30;
              spiral.style.transform = `translateY(${spiralOffset}px)`;
            }
          }

          handleScroll();
          window.addEventListener("scroll", handleScroll, {passive:true});
          window.addEventListener("resize", handleScroll);
        })();
      </script>
    </section>

    <!-- BENEFITS -->
    <section class="benefits">
      <div class="benefits-inner">
        <div class="benefit-block">
          <h3>Secure Payment</h3>
          <p>
            “Shop with confidence. Secure checkout guaranteed.”<br>
            “Your payment info is safe with us.”<br>
            “Encrypted &amp; trusted payment processing.”
          </p>
        </div>

        <div class="benefit-block">
          <h3>Fast Shipping</h3>
          <p>
            “Quick delivery. Because you’re busy.”<br>
            “Fast, tracked shipping on all orders.”<br>
            “Get it sooner. Express shipping options.”
          </p>
        </div>

        <div class="benefit-block">
          <h3>Customer Support</h3>
          <p>
            “We’ve got you. 24/7 support.”<br>
            “Help anytime. Reach out, we’re here.”<br>
            “Your questions answered, fast.”
          </p>
        </div>

        <div class="benefit-block">
          <h3>Quality Promise</h3>
          <p>
            “Crafted with care. Quality you can trust.”<br>
            “Authentic products. Guaranteed.”<br>
            “Only the best. Promise.”
          </p>
        </div>
      </div>
    </section>

  </main>
{% endblock %}
